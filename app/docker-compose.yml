version: "3.11"

services:
   postgres:
      image: postgres:16-alpine
      # restart: always
      env_file: .env
      environment:
         POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
         POSTGRES_USER: ${POSTGRES_USER}
         POSTGRES_DB: ${POSTGRES_DB}
      ports:
         - 5432:5432

   bot:
      build: .
      restart: always
      env_file: .env
      depends_on:
         - postgres
      command: sh -c "alembic upgrade head && python main.py"

# volumes:
#   #  redis-data:
#    postgres-data: